(function(){var e;e=["luminateControllers","ui.bootstrap"],angular.module("ngLuminateLibrary",e),angular.module("luminateControllers",[]),angular.module("ngLuminateLibrary").constant("APP_INFO",{version:"1.0.0",rootPath:"/"}),angular.module("trControllers").directive("trThermometers",["NG_APP_INFO","$rootScope",function(e,r){return{templateUrl:e.rootPath+"dist/html/directive/trThermometers.html",controller:["$rootScope","$scope","$attrs","$uibModal","$filter","NG_APP_INFO","TeamraiserDataService","TeamraiserParticipantService","TeamraiserRegistrationService","TeamraiserTeamService","TeamraiserSuggestionService",function(i,s,e,r,p,a,t,o,l,n,d){return s.path=a.rootPath,s.type=e.type,s.attrs=e,s.location=e.location?s.$eval(e.location):null,s.thermometer={isLoading:!0,goal:0,dollars:0,dollarsFormatted:0,message:null,prevYear:"",prevDollars:0,prevTeams:0,prevParticipants:0,hideTherm:!1},e.raised&&e.goal&&e.percent?s.thermometer={goal:p("currency")(Number(s.$eval(e.goal))/100,"$").replace(".00",""),dollars:p("currency")(Number(s.$eval(e.raised))/100,"$").replace("$","").replace(/,/g,"").replace(".00",""),dollarsFormatted:p("currency")(Number(s.$eval(e.raised))/100,"$").replace(".00",""),percent:s.$eval(e.percent)+"%",rank:s.$eval(e.rank),total:s.$eval(e.total),daysLeft:s.$eval(e.daysLeft),teamMembers:s.$eval(e.teamMembers),teamCount:s.$eval(e.teamCount),participantCount:s.$eval(e.participantCount),hideTherm:"0"===s.$eval(e.hideTherm)}:("individual"===e.type&&o.getParticipants("&first_name="+encodeURIComponent("%%")+"&last_name="+encodeURIComponent("%")+"&list_page_size=1&fr_id="+i.frId+"&list_filter_column=reg.cons_id&list_filter_text="+i.consId).then(function(e){var r;if(e.data.getParticipantsResponse)return r=e.data.getParticipantsResponse.participant,s.thermometer={percent:String(Math.round(r.amountRaised/r.goal*100))+"%",goal:p("currency")(r.goal/100,"$").replace(".00",""),dollars:p("currency")(r.amountRaised/100,"$").replace("$","").replace(/,/g,"").replace(".00",""),dollarsFormatted:p("currency")(r.amountRaised/100,"$").replace(".00","")}}),"event"===e.type&&(s.thermometer.message="reus_"+i.pagenamePrefix+"thermometer_text",t.getTeamRaiserData().then(function(e){var r,a,t,o;return e.teamraiser&&(o=e.teamraiser,s.thermometer.goal=o.goal,s.thermometer.dollars=o.dollars,s.thermometer.dollarsFormatted=o.dollars,s.thermometer.prevDollars=o.prevDollars,s.thermometer.prevParticipants=o.prevParticipants,s.thermometer.prevTeams=o.prevTeams,""!==o.prevEventDate&&(s.thermometer.prevYear=o.prevEventDate.split("/")[2]),a=Number(s.thermometer.goal.replace(/[^\d.]/g,"")),r=Number(s.thermometer.dollars.replace(/[^\d.]/g,"")),0<a&&0<r?(t=r/a*100,s.thermometer.percent=String(Math.round(r/a*100))+"%",t<25&&"Unrecognized type parameter"!==o.prevFrId&&(s.thermometer.showPrevYear=!0)):"Unrecognized type parameter"!==o.prevFrId&&(s.thermometer.showPrevYear=!0)),delete s.thermometer.isLoading}))),s.refreshFundraisingProgress=function(){return o.getParticipantProgress("fr_id="+i.frId).then(function(e){var r,a,t,o,l,n;return r=e.data.getParticipantProgressResponse.personalProgress,((null!=(a=s.participantRegistration)?a.teamId:void 0)&&"-1"!==(null!=(t=s.participantRegistration)?t.teamId:void 0)||(null!=(o=i.dashboard)&&null!=(l=o.registration)?l.teamId:void 0))&&(n=e.data.getParticipantProgressResponse.teamProgress),s.thermometer.goal="team"===s.type?p("currency")(Number(n.goal)/100,"$").replace(".00",""):p("currency")(Number(r.goal)/100,"$").replace(".00",""),s.thermometer.percent="team"===s.type?n.percent+"%":r.percent+"%",s.$$phase||s.$apply(),e})},s.editGoalOptions={updateGoalSuccess:!1,updateGoalFailure:!1,updateGoalFailureMessage:"",updateGoalInput:null},s.closeGoalAlerts=function(e){if(s.editGoalOptions.updateGoalSuccess=!1,s.editGoalOptions.updateGoalFailure=!1,s.editGoalOptions.updateGoalFailureMessage="",e)return s.cancelEditGoal()},s.editGoal=function(e){return s.closeGoalAlerts(!1),s.editGoalOptions.updateGoalInput=null,s.editGoalModal=r.open({scope:s,templateUrl:a.rootPath+"dist/html/modal/trpc-edit"+e+"Goal.html",size:"sm"})},s.cancelEditGoal=function(){return s.editGoalModal.close()},s.updateGoal=function(e){var r;switch(e){case"Participant":return r="fr_id="+i.frId+"&goal="+(100*s.editGoalOptions.updateGoalInput).toString(),l.updateRegistration(r).then(function(e){var r;return e.data.errorResponse?(s.editGoalOptions.updateGoalFailure=!0,e.data.errorResponse.message?s.editGoalOptions.updateGoalFailureMessage=e.data.errorResponse.message:s.editGoalOptions.updateGoalFailureMessage="An unexpected error occurred."):(s.editGoalOptions.updateGoalSuccess=!0,s.refreshFundraisingProgress(),s.closeGoalAlerts(!0),(null!=(r=i.facebookFundraiserConfig)?r.fundraiserId:void 0)&&FacebookFundraiserService.updateFundraiser().then(function(){return FacebookFundraiserService.syncDonations()})),e});case"Team":return r="team_goal="+(100*s.editGoalOptions.updateGoalInput).toString(),n.updateTeamInformation(r).then(function(e){return e.data.errorResponse?(s.editGoalOptions.updateGoalFailure=!0,e.data.errorResponse.message?s.editGoalOptions.updateGoalFailureMessage=e.data.errorResponse.message:s.editGoalOptions.updateGoalFailureMessage="An unexpected error occurred."):(s.editGoalOptions.updateGoalSuccess=!0,s.refreshFundraisingProgress(),s.closeGoalAlerts(!0),d.dismissSuggestion("RaiseTeamGoal")),e})}}}]}}]),angular.module("luminateControllers").controller("MainCtrl",["$rootScope","$scope","$location",function(e,r,a){return console.log("main ctrl"),e.$location=a,e.baseUrl=a.absUrl().split("#")[0]}])}).call(this);